<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Logistic and Multinomial Logistic Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="logistic_regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="logistic_regression_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="logistic_regression_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="logistic_regression_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="logistic_regression_files/libs/quarto-html/popper.min.js"></script>
<script src="logistic_regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="logistic_regression_files/libs/quarto-html/anchor.min.js"></script>
<link href="logistic_regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="logistic_regression_files/libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="logistic_regression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="logistic_regression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="logistic_regression_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Logistic and Multinomial Logistic Regression</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Model: Regressing binary dependent variable, <code>DRINKING_D</code>, on the following binary and continuous predictors: <code>FATAL_OR_M</code>, <code>OVERTURNED</code>, <code>CELL_PHONE</code>, <code>SPEEDING</code>, <code>AGGRESSIVE</code>, <code>DRIVER1617</code>, <code>DRIVER65PLUS</code>, <code>PCTBACHMOR</code>, and <code>MEDHHINC</code>.</strong></p>
<p>Prior to running any of the analyses, be sure to set the working directory using the <code>setwd</code> command, install the relevant R packages using the <code>install.packages</code> command, and load the relevant packages using the <code>library</code> command.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aod)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'aod' was built under R version 4.5.2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rms' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Hmisc</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Hmisc' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Hmisc'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    format.pval, units</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gmodels' was built under R version 4.5.2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'DAAG'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:rms':

    vif</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ROCR' was built under R version 4.5.2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'xtable' was built under R version 4.5.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'xtable'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:Hmisc':

    label, label&lt;-</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><em>2.</em> Import the file <code>logistic_regression.csv</code> into R using the <code>read.csv</code> command. Now, you are ready to do some exploratory analyses.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cdc_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/logistic_regression.csv"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cdc_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        CRN DRINKING_D COLLISION_ FATAL_OR_M OVERTURNED CELL_PHONE SPEEDING
1 200806719          0          7          0          0          0        0
2 200807695          0          7          1          0          0        0
3 200808809          0          8          0          0          0        0
4 200809857          0          5          0          0          0        0
5 200812736          0          1          0          0          0        0
6 200907381          1          7          1          0          0        0
  AGGRESSIVE DRIVER1617 DRIVER65PLUS      AREAKEY PCTBACHMOR MEDHHINC
1          0          0            0 421010001001    64.4737    49107
2          1          0            0 421010001001    64.4737    49107
3          0          0            0 421010001001    64.4737    49107
4          1          0            0 421010001001    64.4737    49107
5          0          0            0 421010001001    64.4737    49107
6          0          0            1 421010001001    64.4737    49107</code></pre>
</div>
</div>
<p><em>2.a.</em> Using the table and prop.table commands, tabulate the dependent variable, <code>DRINKING_D.</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>DRINKING_D.tab <span class="ot">&lt;-</span> <span class="fu">table</span>(cdc_data<span class="sc">$</span>DRINKING_D)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(DRINKING_D.tab)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1 
0.9426944 0.0573056 </code></pre>
</div>
</div>
<p>In your report, in addition to the counts that you can obtain with the table command, you will be asked to report the proportion of crashes that involved a drunk driver using the prop.table command as above.</p>
<p><em>2.b.</em> Using the CrossTable command in the gmodels library, examine the cross-tabulations between the dependent variable, <code>DRINKING_D</code>, and the following binary predictor variables: <code>FATAL_OR_M</code>, <code>OVERTURNED</code>, <code>CELL_PHONE</code>, <code>SPEEDING</code>, <code>AGGRESSIVE</code>, <code>DRIVER1617</code>, and <code>DRIVER65PLUS</code>.</p>
<p><em>2.b.i.</em> For the first predictor (<code>FATAL_OR_M</code>), record the number and percentage of 1-responses (i.e., fatalities or major injuries) for both categories of the variable <code>DRINKING_D</code>, as well as the total number of 1-responses (i.e., fatalities or major injuries) in the data set. That is, how many fatalities or major injuries were there when the driver wasn’t inebriated, when the driver was inebriated, and altogether?</p>
<p><em>2.b.ii.</em> Repeat step <em>2.b.i</em> above for the rest of the binary predictors.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I made a function to loop through it so I don't have to do this 7 separate times.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create predictor vector.</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FATAL_OR_M"</span>, <span class="st">"OVERTURNED"</span>, <span class="st">"CELL_PHONE"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SPEEDING"</span>, <span class="st">"AGGRESSIVE"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DRIVER1617"</span>, <span class="st">"DRIVER65PLUS"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty results dataframe.</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>binary_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> <span class="fu">character</span>(),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Drink0_Count_1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Drink1_Count_1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ChiSq =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each predictor.</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> predictors) {</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=======================================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"PREDICTOR:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build 2x2 table.</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(cdc_data<span class="sc">$</span>DRINKING_D, cdc_data[[var]])</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tab)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Row percentages.</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Row percentages (within DRINKING_D):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(tab, <span class="dv">1</span>), <span class="dv">4</span>))</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count the number of 1's.</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  total_ones <span class="ot">&lt;-</span> <span class="fu">sum</span>(cdc_data[[var]] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total number of"</span>, var, <span class="st">"= 1 in dataset:"</span>, total_ones, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Chi-square test.</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tab, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square statistic:"</span>, test<span class="sc">$</span>statistic,</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">"</span><span class="sc">\n</span><span class="st">Degrees of freedom:"</span>, test<span class="sc">$</span>parameter,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">"</span><span class="sc">\n</span><span class="st">p-value:"</span>, test<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add row to results dataframe.</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>  binary_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    binary_results,</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">Predictor =</span> var,</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">Drink0_Count_1 =</span> tab[<span class="st">"0"</span>, <span class="st">"1"</span>],</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">Drink1_Count_1 =</span> tab[<span class="st">"1"</span>, <span class="st">"1"</span>],</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_1 =</span> total_ones,</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">ChiSq =</span> <span class="fu">unname</span>(test<span class="sc">$</span>statistic),</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> test<span class="sc">$</span>p.value</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=======================================================
PREDICTOR: FATAL_OR_M 
   
        0     1
  0 39698  1181
  1  2297   188

Row percentages (within DRINKING_D):
   
         0      1
  0 0.9711 0.0289
  1 0.9243 0.0757

Total number of FATAL_OR_M = 1 in dataset: 1369 

Chi-square statistic: 167.5615 
Degrees of freedom: 1 
p-value: 0.00000000000000000000000000000000000002522202 
=======================================================
PREDICTOR: OVERTURNED 
   
        0     1
  0 40267   612
  1  2375   110

Row percentages (within DRINKING_D):
   
         0      1
  0 0.9850 0.0150
  1 0.9557 0.0443

Total number of OVERTURNED = 1 in dataset: 722 

Chi-square statistic: 122.788 
Degrees of freedom: 1 
p-value: 0.0000000000000000000000000001551762 
=======================================================
PREDICTOR: CELL_PHONE 
   
        0     1
  0 40453   426
  1  2457    28

Row percentages (within DRINKING_D):
   
         0      1
  0 0.9896 0.0104
  1 0.9887 0.0113

Total number of CELL_PHONE = 1 in dataset: 454 

Chi-square statistic: 0.162071 
Degrees of freedom: 1 
p-value: 0.6872569 
=======================================================
PREDICTOR: SPEEDING 
   
        0     1
  0 39618  1261
  1  2225   260

Row percentages (within DRINKING_D):
   
         0      1
  0 0.9692 0.0308
  1 0.8954 0.1046

Total number of SPEEDING = 1 in dataset: 1521 

Chi-square statistic: 376.7808 
Degrees of freedom: 1 
p-value: 0.000000000000000000000000000000000000000000000000000000000000000000000000000000000006249562 
=======================================================
PREDICTOR: AGGRESSIVE 
   
        0     1
  0 22357 18522
  1  1569   916

Row percentages (within DRINKING_D):
   
         0      1
  0 0.5469 0.4531
  1 0.6314 0.3686

Total number of AGGRESSIVE = 1 in dataset: 19438 

Chi-square statistic: 67.60186 
Degrees of freedom: 1 
p-value: 0.000000000000000200079 
=======================================================
PREDICTOR: DRIVER1617 
   
        0     1
  0 40205   674
  1  2473    12

Row percentages (within DRINKING_D):
   
         0      1
  0 0.9835 0.0165
  1 0.9952 0.0048

Total number of DRIVER1617 = 1 in dataset: 686 

Chi-square statistic: 20.45167 
Degrees of freedom: 1 
p-value: 0.000006115619 
=======================================================
PREDICTOR: DRIVER65PLUS 
   
        0     1
  0 36642  4237
  1  2366   119

Row percentages (within DRINKING_D):
   
         0      1
  0 0.8964 0.1036
  1 0.9521 0.0479

Total number of DRIVER65PLUS = 1 in dataset: 4356 

Chi-square statistic: 80.6047 
Degrees of freedom: 1 
p-value: 0.000000000000000000275703 </code></pre>
</div>
</div>
<p><em>2.b.iii.</em> In your report, you will be asked to present the cross-tabulations from <em>2.b.i</em> and <em>2.b.ii</em> in a table.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build summary table.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>binary_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> <span class="fu">character</span>(),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">DRINKING_D =</span> <span class="fu">integer</span>(),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count_1 =</span> <span class="fu">integer</span>(),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Percent_1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_1 =</span> <span class="fu">integer</span>(),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> predictors) {</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">DRINKING_D =</span> cdc_data<span class="sc">$</span>DRINKING_D,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">Predictor   =</span> cdc_data[[var]])</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  row_props <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="dv">1</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  total_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(tab[, <span class="st">"1"</span>])</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> <span class="fu">rownames</span>(tab)) {</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    binary_summary <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>      binary_summary,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">Predictor  =</span> var,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">DRINKING_D =</span> <span class="fu">as.integer</span>(d),</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">Count_1    =</span> <span class="fu">as.integer</span>(tab[d, <span class="st">"1"</span>]),</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">Percent_1  =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(row_props[d, <span class="st">"1"</span>]),</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">Total_1    =</span> total_1</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>binary_summary<span class="sc">$</span>DRINKING_D <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  binary_summary<span class="sc">$</span>DRINKING_D <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"No Alcohol"</span>, <span class="st">"Alcohol"</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(binary_summary, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Predictor</th>
<th style="text-align: left;">DRINKING_D</th>
<th style="text-align: right;">Count_1</th>
<th style="text-align: right;">Percent_1</th>
<th style="text-align: right;">Total_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">1181</td>
<td style="text-align: right;">2.89</td>
<td style="text-align: right;">1369</td>
</tr>
<tr class="even">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">7.57</td>
<td style="text-align: right;">1369</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">612</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">722</td>
</tr>
<tr class="even">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">4.43</td>
<td style="text-align: right;">722</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">426</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">454</td>
</tr>
<tr class="even">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">454</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">1261</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">1521</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">10.46</td>
<td style="text-align: right;">1521</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">18522</td>
<td style="text-align: right;">45.31</td>
<td style="text-align: right;">19438</td>
</tr>
<tr class="even">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">916</td>
<td style="text-align: right;">36.86</td>
<td style="text-align: right;">19438</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">674</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">686</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">686</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">4237</td>
<td style="text-align: right;">10.36</td>
<td style="text-align: right;">4356</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">119</td>
<td style="text-align: right;">4.79</td>
<td style="text-align: right;">4356</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>2.b.iv.</em> Prior to doing predictive modeling, statisticians often use the Chi-Square (χ2) test to determine whether the distribution of one categorical variable varies with respect to the values of another categorical variable. If we were to look at a cross-tabulation of the variables <code>DRINKING_D</code> and <code>FATAL_OR_M</code>, the null and alternative hypotheses for the χ2 test would be as follows:</p>
<p><em>H0:</em> The proportion of fatalities for crashes that involve drunk drivers is the same as the proportion of fatalities for crashes that don’t involve drunk drivers.</p>
<p>vs.</p>
<p><em>Ha:</em> The proportion of fatalities for crashes that involve drunk drivers is different than the proportion of fatalities for crashes that don’t involve drunk drivers.</p>
<p>As usual, a high value of the χ2 statistic, and a p-value lower than 0.05 suggest that there’s evidence to reject the null hypothesis in favor of the alternative, and that there’s an association between drunk driving and crash fatalities.</p>
<p><em>2.b.iv.1.</em> To carry out the χ2 test in R to test the hypothesis above, you would use the syntax <code>CrossTable(cdc_data$FATAL_OR_M, cdc_data$DRINKING_D, prop.r = FALSE, prop.t = FALSE, prop.chisq = FALSE, chisq = TRUE)</code>. The χ2 results will appear below the cross-tabulation table that you have seen in <em>2.b.i</em> above. Report the results without the Yates Continuity Correction.</p>
<p><em>2.b.iv.2.</em> Modifying the syntax in <em>2.b.iv.1</em> above, run the χ2 test examining the association between the dependent variable and the remaining binary predictors.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>chi_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> predictors,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chi_sq =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="dv">1</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="cn">NA_real_</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(predictors)) {</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> predictors[i]</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(cdc_data<span class="sc">$</span>DRINKING_D, cdc_data[[var]])</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tab, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  chi_results<span class="sc">$</span>Chi_sq[i] <span class="ot">&lt;-</span> test<span class="sc">$</span>statistic</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  chi_results<span class="sc">$</span>p_value[i] <span class="ot">&lt;-</span> test<span class="sc">$</span>p.value</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(chi_results, <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Predictor</th>
<th style="text-align: right;">Chi_sq</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: right;">167.5615</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: right;">122.7880</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: right;">0.1621</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.6873</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: right;">376.7808</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: right;">67.6019</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: right;">20.4517</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: right;">80.6047</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>2.b.iv.3.</em> In the table <em>2.b.iii</em> above, add another column called “χ2 p-value”. For each row, present the p-value from the corresponding χ2 test.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>binary_summary2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(binary_summary, chi_results, <span class="at">by =</span> <span class="st">"Predictor"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(binary_summary2, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 4%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Predictor</th>
<th style="text-align: left;">DRINKING_D</th>
<th style="text-align: right;">Count_1</th>
<th style="text-align: right;">Percent_1</th>
<th style="text-align: right;">Total_1</th>
<th style="text-align: right;">Chi_sq</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">18522</td>
<td style="text-align: right;">45.309</td>
<td style="text-align: right;">19438</td>
<td style="text-align: right;">67.602</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">916</td>
<td style="text-align: right;">36.861</td>
<td style="text-align: right;">19438</td>
<td style="text-align: right;">67.602</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">426</td>
<td style="text-align: right;">1.042</td>
<td style="text-align: right;">454</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.687</td>
</tr>
<tr class="even">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.127</td>
<td style="text-align: right;">454</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.687</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">674</td>
<td style="text-align: right;">1.649</td>
<td style="text-align: right;">686</td>
<td style="text-align: right;">20.452</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.483</td>
<td style="text-align: right;">686</td>
<td style="text-align: right;">20.452</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">4237</td>
<td style="text-align: right;">10.365</td>
<td style="text-align: right;">4356</td>
<td style="text-align: right;">80.605</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">119</td>
<td style="text-align: right;">4.789</td>
<td style="text-align: right;">4356</td>
<td style="text-align: right;">80.605</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">1181</td>
<td style="text-align: right;">2.889</td>
<td style="text-align: right;">1369</td>
<td style="text-align: right;">167.562</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">7.565</td>
<td style="text-align: right;">1369</td>
<td style="text-align: right;">167.562</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">612</td>
<td style="text-align: right;">1.497</td>
<td style="text-align: right;">722</td>
<td style="text-align: right;">122.788</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">4.427</td>
<td style="text-align: right;">722</td>
<td style="text-align: right;">122.788</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">1261</td>
<td style="text-align: right;">3.085</td>
<td style="text-align: right;">1521</td>
<td style="text-align: right;">376.781</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">10.463</td>
<td style="text-align: right;">1521</td>
<td style="text-align: right;">376.781</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>2.b.iv.3.a.</em> Note, however, that in practice, statisticians generally present not just the p-value, but also the value of the χ2 statistic and the degrees of freedom, which is the parameter of the χ2 distribution. The degrees of freedom is calculated as (R − 1)(C − 1), where R is the number of rows in the cross-tabulation table and C is the number of columns in the cross-tabulation table. Said differently, R is the number of categories of the first variable and C is the number of categories in the second variable. Here, because we are cross-tabulating two binary variables, both R and C are 2, and df = (R − 1)(C − 1) = 1.</p>
<p><em>2.c.</em> Now, let’s examine whether the means of the two continuous predictors seem to differ for the different levels of the dependent variable. To do this, calculate the group means (and standard deviations) of both predictors (<code>PCTBACHMOR</code> and <code>MEDHHINC</code>) for crashes that involve drunk drivers and crashes that don’t.</p>
<p><em>2.c.i.</em> In order to do this in R, use the <code>tapply</code> command. For instance, if you want to calculate the average values of the variable <code>PCTBACHMOR</code> for crashes that involve drunk drivers and crashes that don’t, you would use the following syntax: <code>tapply(cdc_data$PCTBACHMOR, cdc_data$DRINKING_D, mean)</code>. To calculate the standard deviations of the variable <code>PCTBACHMOR</code> for crashes that involve drunk drivers and crashes that don’t, you would use the following syntax: <code>tapply(cdc_data$PCTBACHMOR, cdc_data$DRINKING_D, sd)</code>.</p>
<p><em>2.c.ii.</em> Present your results in a table.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PCTBACHMOR"</span>, <span class="st">"MEDHHINC"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>mean_sd_table <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(continuous_vars, <span class="cf">function</span>(v) {</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Predictor =</span> v,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">c</span>(<span class="st">"No Alcohol"</span>, <span class="st">"Alcohol"</span>),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">tapply</span>(cdc_data[[v]], cdc_data<span class="sc">$</span>DRINKING_D, mean),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">tapply</span>(cdc_data[[v]], cdc_data<span class="sc">$</span>DRINKING_D, sd)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mean_sd_table, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Predictor</th>
<th style="text-align: left;">Group</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">PCTBACHMOR</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">16.57</td>
<td style="text-align: right;">18.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">PCTBACHMOR</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">16.61</td>
<td style="text-align: right;">18.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">MEDHHINC</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">31483.05</td>
<td style="text-align: right;">16930.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: left;">MEDHHINC</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">31998.75</td>
<td style="text-align: right;">17810.50</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>2.c.iii.</em> Recall from introductory statistics classes that in order to compare the mean value of a continuous variable for two independent groups, statisticians usually employ a test that’s called the independent samples t-test. For example, we can see whether the average <code>PCTBACHMOR</code> values are statistically significantly different for crashes that involve drunk drivers and crashes that don’t. The null and alternative hypotheses for the independent samples t-test would be as follows:</p>
<p><em>H0:</em> average values of the variable <code>PCTBACHMOR</code> are the same for crashes that involve drunk drivers and crashes that don’t.</p>
<p>vs.</p>
<p><em>Ha:</em> average values of the variable <code>PCTBACHMOR</code> are different for crashes that involve drunk drivers and crashes that don’t.</p>
<p>A high value of the t-statistic, and a p-value lower than 0.05 suggest that there’s evidence to reject the null hypothesis in favor of the alternative.</p>
<p><em>2.c.iii.1.</em> To carry out the t-test in R to test the hypothesis above, you would use the syntax <code>t.test(mydata$PCTBACHMOR~mydata$DRINKING_D)</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>t_PCTB <span class="ot">&lt;-</span> <span class="fu">t.test</span>(cdc_data<span class="sc">$</span>PCTBACHMOR <span class="sc">~</span> cdc_data<span class="sc">$</span>DRINKING_D)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>t_MEDH <span class="ot">&lt;-</span> <span class="fu">t.test</span>(cdc_data<span class="sc">$</span>MEDHHINC <span class="sc">~</span> cdc_data<span class="sc">$</span>DRINKING_D)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>t_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> <span class="fu">c</span>(<span class="st">"PCTBACHMOR"</span>, <span class="st">"MEDHHINC"</span>),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">t_stat =</span> <span class="fu">c</span>(t_PCTB<span class="sc">$</span>statistic, t_MEDH<span class="sc">$</span>statistic),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">c</span>(t_PCTB<span class="sc">$</span>parameter, t_MEDH<span class="sc">$</span>parameter),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="fu">c</span>(t_PCTB<span class="sc">$</span>p.value, t_MEDH<span class="sc">$</span>p.value)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(t_table, <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Predictor</th>
<th style="text-align: right;">t_stat</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PCTBACHMOR</td>
<td style="text-align: right;">-0.1084</td>
<td style="text-align: right;">2777.542</td>
<td style="text-align: right;">0.9137</td>
</tr>
<tr class="even">
<td style="text-align: left;">MEDHHINC</td>
<td style="text-align: right;">-1.4053</td>
<td style="text-align: right;">2763.870</td>
<td style="text-align: right;">0.1600</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>2.c.iii.2.</em> Repeat the t-test for the variable <code>MEDHHINC.</code></p>
<p><em>2.c.iii.3.</em> In the table <em>2.c.ii</em> above, add another column called “t-test pvalue”. For each row, present the p-value from the corresponding t-test.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mean_sd_table2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(mean_sd_table, t_table, <span class="at">by =</span> <span class="st">"Predictor"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mean_sd_table2, <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Predictor</th>
<th style="text-align: left;">Group</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">t_stat</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MEDHHINC</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">31483.0547</td>
<td style="text-align: right;">16930.1016</td>
<td style="text-align: right;">-1.4053</td>
<td style="text-align: right;">2763.870</td>
<td style="text-align: right;">0.1600</td>
</tr>
<tr class="even">
<td style="text-align: left;">MEDHHINC</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">31998.7529</td>
<td style="text-align: right;">17810.4973</td>
<td style="text-align: right;">-1.4053</td>
<td style="text-align: right;">2763.870</td>
<td style="text-align: right;">0.1600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PCTBACHMOR</td>
<td style="text-align: left;">No Alcohol</td>
<td style="text-align: right;">16.5699</td>
<td style="text-align: right;">18.2143</td>
<td style="text-align: right;">-0.1084</td>
<td style="text-align: right;">2777.542</td>
<td style="text-align: right;">0.9137</td>
</tr>
<tr class="even">
<td style="text-align: left;">PCTBACHMOR</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">16.6117</td>
<td style="text-align: right;">18.7209</td>
<td style="text-align: right;">-0.1084</td>
<td style="text-align: right;">2777.542</td>
<td style="text-align: right;">0.9137</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>2.c.iii.3.a.</em> Note, however, that in practice, statisticians generally present not just the p-value, but also the value of the t-statistic and the degrees of freedom.</p>
<p><em>2.d.</em> Using the instructions from Assignment 1, examine the Pearson correlations between all the predictors (both binary and continuous). Is there evidence of severe multicollinearity here? (Be sure the appropriate R library is loaded).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>all_predictors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  predictors,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PCTBACHMOR"</span>, <span class="st">"MEDHHINC"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cdc_data[, all_predictors], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(corr_matrix, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">FATAL_OR_M</th>
<th style="text-align: right;">OVERTURNED</th>
<th style="text-align: right;">CELL_PHONE</th>
<th style="text-align: right;">SPEEDING</th>
<th style="text-align: right;">AGGRESSIVE</th>
<th style="text-align: right;">DRIVER1617</th>
<th style="text-align: right;">DRIVER65PLUS</th>
<th style="text-align: right;">PCTBACHMOR</th>
<th style="text-align: right;">MEDHHINC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">-0.011</td>
<td style="text-align: right;">-0.003</td>
<td style="text-align: right;">-0.013</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">-0.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">-0.020</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.028</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.004</td>
<td style="text-align: right;">-0.026</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">-0.003</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">-0.004</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-0.033</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.012</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: right;">-0.011</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-0.026</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.043</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: right;">-0.003</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.021</td>
<td style="text-align: right;">-0.003</td>
<td style="text-align: right;">0.023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: right;">-0.013</td>
<td style="text-align: right;">-0.020</td>
<td style="text-align: right;">-0.003</td>
<td style="text-align: right;">-0.033</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">-0.021</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">0.050</td>
</tr>
<tr class="even">
<td style="text-align: left;">PCTBACHMOR</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">-0.003</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.478</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MEDHHINC</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.478</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>3.</em> Now that we’re done with exploratory analysis, we are ready to proceed to running the logistic regression.</p>
<p><em>3.a.</em> Using the <code>glm</code> command for logistic regression (as shown in the slides), regress the <code>DRINKING_D</code> variable on the following predictors: <code>FATAL_OR_M</code>, <code>OVERTURNED</code>, <code>CELL_PHONE</code>, <code>SPEEDING</code>, <code>AGGRESSIVE</code>, <code>DRIVER1617</code>, <code>DRIVER65PLUS</code>, <code>PCTBACHMOR</code>, and <code>MEDHHINC</code>.</p>
<p><em>3.a.i.</em> Use the summary command to examine the results.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>logit_full <span class="ot">&lt;-</span> <span class="fu">glm</span>(DRINKING_D <span class="sc">~</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                    FATAL_OR_M <span class="sc">+</span> OVERTURNED <span class="sc">+</span> CELL_PHONE <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                    SPEEDING <span class="sc">+</span> AGGRESSIVE <span class="sc">+</span> DRIVER1617 <span class="sc">+</span> DRIVER65PLUS <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                    PCTBACHMOR <span class="sc">+</span> MEDHHINC,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> binomial,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> cdc_data</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_full)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = DRINKING_D ~ FATAL_OR_M + OVERTURNED + CELL_PHONE + 
    SPEEDING + AGGRESSIVE + DRIVER1617 + DRIVER65PLUS + PCTBACHMOR + 
    MEDHHINC, family = binomial, data = cdc_data)

Coefficients:
                 Estimate   Std. Error z value             Pr(&gt;|z|)    
(Intercept)  -2.732506616  0.045875659 -59.563 &lt; 0.0000000000000002 ***
FATAL_OR_M    0.814013802  0.083806924   9.713 &lt; 0.0000000000000002 ***
OVERTURNED    0.928921376  0.109166324   8.509 &lt; 0.0000000000000002 ***
CELL_PHONE    0.029550085  0.197777821   0.149               0.8812    
SPEEDING      1.538975665  0.080545894  19.107 &lt; 0.0000000000000002 ***
AGGRESSIVE   -0.596915946  0.047779238 -12.493 &lt; 0.0000000000000002 ***
DRIVER1617   -1.280295964  0.293147168  -4.367 0.000012572447127933 ***
DRIVER65PLUS -0.774664640  0.095858315  -8.081 0.000000000000000641 ***
PCTBACHMOR   -0.000370634  0.001296387  -0.286               0.7750    
MEDHHINC      0.000002804  0.000001341   2.091               0.0365 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 19036  on 43363  degrees of freedom
Residual deviance: 18340  on 43354  degrees of freedom
AIC: 18360

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p><em>3.a.ii.</em> For each predictor, also compute the odds ratio and the 95% confidence interval (CI) using commands shown in the slides. Use the syntax presented on the slide titled ‘Merging Odds Ratios to 𝛽 Coefficients in R’ to merge the odds ratios and CIs to the matrix that contains coefficients and p-values. Present the resulting (merged) matrix in your report.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">summary</span>(logit_full)<span class="sc">$</span>coefficients</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>OR <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_full))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_full) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coefs[, <span class="st">"Std. Error"</span>])</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_full) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coefs[, <span class="st">"Std. Error"</span>])</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coefs, OR, lower, upper)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(merged, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 24%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">z value</th>
<th style="text-align: right;">Pr(&gt;|z|)</th>
<th style="text-align: right;">OR</th>
<th style="text-align: right;">lower</th>
<th style="text-align: right;">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-2.733</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">-59.563</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.071</td>
</tr>
<tr class="even">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">9.713</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.257</td>
<td style="text-align: right;">1.915</td>
<td style="text-align: right;">2.660</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: right;">0.929</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">8.509</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.532</td>
<td style="text-align: right;">2.044</td>
<td style="text-align: right;">3.136</td>
</tr>
<tr class="even">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.198</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">1.030</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">1.518</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: right;">1.539</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">19.107</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">4.660</td>
<td style="text-align: right;">3.979</td>
<td style="text-align: right;">5.457</td>
</tr>
<tr class="even">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: right;">-0.597</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">-12.493</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.551</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.605</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: right;">-1.280</td>
<td style="text-align: right;">0.293</td>
<td style="text-align: right;">-4.367</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.494</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: right;">-0.775</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">-8.081</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.461</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">0.556</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PCTBACHMOR</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">-0.286</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.997</td>
<td style="text-align: right;">1.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">MEDHHINC</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.091</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>3.a.iii.</em> Using the syntax presented in the slides, calculate the sensitivity, specificity and misclassification rate for each of the following cut-off values: <strong>0.02; 0.03; 0.05; 0.07; 0.08; 0.09; 0.10; 0.15; 0.20; 0.50</strong> and present them in a table. In the table, highlight the cut-off value which has the lowest misclassification rate.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.05</span>, <span class="fl">0.07</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.10</span>, <span class="fl">0.15</span>, <span class="fl">0.20</span>, <span class="fl">0.50</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> logit_full<span class="sc">$</span>fitted.values</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> cdc_data<span class="sc">$</span>DRINKING_D</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>cutoff_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cutoff =</span> cutoffs,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensitivity =</span> <span class="cn">NA</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificity =</span> <span class="cn">NA</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Misclass =</span> <span class="cn">NA</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(cutoffs)) {</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> cutoffs[i]</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(phat <span class="sc">&gt;=</span> c, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> y <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> y <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> y <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> y <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  cutoff_table<span class="sc">$</span>Sensitivity[i] <span class="ot">&lt;-</span> TP<span class="sc">/</span>(TP<span class="sc">+</span>FN)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  cutoff_table<span class="sc">$</span>Specificity[i] <span class="ot">&lt;-</span> TN<span class="sc">/</span>(TN<span class="sc">+</span>FP)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  cutoff_table<span class="sc">$</span>Misclass[i] <span class="ot">&lt;-</span> (FP<span class="sc">+</span>FN)<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  cutoff_table,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Sensitivity, Specificity, and Misclassification Across Cutoffs"</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Sensitivity, Specificity, and Misclassification Across Cutoffs</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Cutoff</th>
<th style="text-align: right;">Sensitivity</th>
<th style="text-align: right;">Specificity</th>
<th style="text-align: right;">Misclass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.984</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">0.889</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.981</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.884</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.735</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.516</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">0.126</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.185</td>
<td style="text-align: right;">0.939</td>
<td style="text-align: right;">0.105</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">0.946</td>
<td style="text-align: right;">0.099</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.164</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: right;">0.097</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">0.972</td>
<td style="text-align: right;">0.078</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.060</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.057</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>: Sensitivity, Specificity, and Misclassification Table</p>
<p><em>3.a.iv.</em> Using the syntax presented in the slides, generate the ROC curve, and identify the optimal cut-off value. Be sure to export the image of the ROC curve (as you will be expected to present it in your report).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(phat, y)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">main=</span><span class="st">"ROC Curve"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="logistic_regression_files/figure-html/ROC%20curve-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>auc_value</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6398695</code></pre>
</div>
</div>
<p><em>3.a.v.</em> Using the syntax presented in the slides, calculate the area under the ROC curve.</p>
<p><em>3.b.</em> Re-run the model without the <code>PCTBACHMOR</code> and <code>MEDHHINC</code> terms. As in <em>3.a.i</em> and <em>3.a.ii</em> above, use the summary command to examine results, and calculate the odds ratio and the 95% confidence interval for each predictor. As in <em>3.a.ii</em> above, merge the odds ratios and confidence intervals to the matrix containing coefficients and p-values. Present the resulting (merged) matrix in your report.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>logit_reduced <span class="ot">&lt;-</span> <span class="fu">glm</span>(DRINKING_D <span class="sc">~</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                       FATAL_OR_M <span class="sc">+</span> OVERTURNED <span class="sc">+</span> CELL_PHONE <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                       SPEEDING <span class="sc">+</span> AGGRESSIVE <span class="sc">+</span> DRIVER1617 <span class="sc">+</span> DRIVER65PLUS,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> cdc_data,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> binomial</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_reduced)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = DRINKING_D ~ FATAL_OR_M + OVERTURNED + CELL_PHONE + 
    SPEEDING + AGGRESSIVE + DRIVER1617 + DRIVER65PLUS, family = binomial, 
    data = cdc_data)

Coefficients:
             Estimate Std. Error z value             Pr(&gt;|z|)    
(Intercept)  -2.65190    0.02753 -96.324 &lt; 0.0000000000000002 ***
FATAL_OR_M    0.80932    0.08376   9.662 &lt; 0.0000000000000002 ***
OVERTURNED    0.93978    0.10903   8.619 &lt; 0.0000000000000002 ***
CELL_PHONE    0.03107    0.19777   0.157                0.875    
SPEEDING      1.54032    0.08053  19.128 &lt; 0.0000000000000002 ***
AGGRESSIVE   -0.59365    0.04775 -12.433 &lt; 0.0000000000000002 ***
DRIVER1617   -1.27158    0.29311  -4.338  0.00001436374143265 ***
DRIVER65PLUS -0.76646    0.09576  -8.004  0.00000000000000121 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 19036  on 43363  degrees of freedom
Residual deviance: 18344  on 43356  degrees of freedom
AIC: 18360

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>reduced_coefs <span class="ot">&lt;-</span> <span class="fu">summary</span>(logit_reduced)<span class="sc">$</span>coefficients</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>OR2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_reduced))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>CI2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_reduced))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>reduced_logit_results <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  reduced_coefs,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">OR =</span> OR2,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_low =</span> CI2[,<span class="dv">1</span>],</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_high =</span> CI2[,<span class="dv">2</span>]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  reduced_logit_results,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption=</span><span class="st">"Reduced Logistic Model: Coefficients, OR, CI"</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Reduced Logistic Model: Coefficients, OR, CI</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 23%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">z value</th>
<th style="text-align: right;">Pr(&gt;|z|)</th>
<th style="text-align: right;">OR</th>
<th style="text-align: right;">CI_low</th>
<th style="text-align: right;">CI_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-2.652</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">-96.324</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.074</td>
</tr>
<tr class="even">
<td style="text-align: left;">FATAL_OR_M</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">9.662</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.246</td>
<td style="text-align: right;">1.901</td>
<td style="text-align: right;">2.640</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OVERTURNED</td>
<td style="text-align: right;">0.940</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">8.619</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">2.559</td>
<td style="text-align: right;">2.057</td>
<td style="text-align: right;">3.156</td>
</tr>
<tr class="even">
<td style="text-align: left;">CELL_PHONE</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.198</td>
<td style="text-align: right;">0.157</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">1.032</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">1.491</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPEEDING</td>
<td style="text-align: right;">1.540</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">19.128</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">4.666</td>
<td style="text-align: right;">3.980</td>
<td style="text-align: right;">5.457</td>
</tr>
<tr class="even">
<td style="text-align: left;">AGGRESSIVE</td>
<td style="text-align: right;">-0.594</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">-12.433</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.552</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.606</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DRIVER1617</td>
<td style="text-align: right;">-1.272</td>
<td style="text-align: right;">0.293</td>
<td style="text-align: right;">-4.338</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.280</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.475</td>
</tr>
<tr class="even">
<td style="text-align: left;">DRIVER65PLUS</td>
<td style="text-align: right;">-0.766</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">-8.004</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.465</td>
<td style="text-align: right;">0.383</td>
<td style="text-align: right;">0.558</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>3.c.</em> Compare the two models using the Akaike Information Criterion (AIC). The results are typically presented at the bottom of the logistic regression output. They may also be obtained using the <code>AIC</code> command. For instance, if the results obtained from the <code>glm</code> command for the first model are saved as <code>mylogit1</code> and the results from the second model are saved as <code>mylogit2</code>, the R syntax to obtain the AICs from both models would be <code>AIC(mylogit1, mylogit2)</code>. Here, recall that lower values of the AIC correspond to a better model.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(logit_full, logit_reduced)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              df      AIC
logit_full    10 18359.63
logit_reduced  8 18360.47</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>